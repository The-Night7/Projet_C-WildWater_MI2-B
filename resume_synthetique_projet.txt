Objectif principal :
Créer une application composée d’un script Shell et d’un programme C pour analyser et traiter des données liées à un système de distribution d’eau potable en France. Les données sont fournies dans un fichier CSV volumineux (plus de 8 millions de lignes et 500 Mo).

Structure des données :


Fichier CSV :

Chaque ligne décrit un tronçon du réseau ou une entité (source, usine, stockage, etc.).
Les colonnes principales :

Identifiant unique de l’usine ayant traité l’eau.
Identifiant "amont" (acteur source).
Identifiant "aval" (acteur destination).
Volume d’eau (en milliers de m³).
Pourcentage de fuites (%).


Les valeurs manquantes sont représentées par un tiret -.



Topologie simplifiée :

Sources : Points de captage (environ 30 000).
Usines de traitement : Transformant l’eau en potable (environ 15 000).
Espaces de stockage : Réservoirs, châteaux d’eau, etc. (environ 30 000).
Distribution : Réseau divisé en :

Distribution principale (stockage → jonctions).
Distribution secondaire (jonctions → raccordements).
Branchements (raccordements → usagers).


Usagers : Plus de 20 millions de compteurs d’eau.




Fonctionnalités à implémenter :
1. Histogramme des performances des usines :

Générer un histogramme basé sur une des trois informations choisies par l’utilisateur :

Capacité maximale de traitement (volume maximal annuel traité par usine).
Volume total capté (somme des volumes d’eau captés par les sources alimentant une usine).
Volume total réellement traité (volume capté pondéré par les pertes avant l’usine).


Sortie attendue :

Fichier CSV contenant les résultats triés par identifiant d’usine (ordre alphabétique inverse).
Image PNG de l’histogramme avec les 5 plus grandes et 5 plus petites valeurs.



2. Calcul des pertes d’eau d’une usine :

Calculer le volume d’eau perdu dans tout le réseau aval d’une usine donnée.
Hypothèses :

L’eau est répartie équitablement entre les nœuds enfants.


Sortie attendue :

Volume total de pertes en millions de m³.
Fichier d’historique des rendements avec l’identifiant de l’usine et son volume de pertes.




Contraintes techniques :
Script Shell :

Rôle : Point d’entrée du projet, il orchestre les traitements.
Arguments possibles :

histo max : Histogramme basé sur la capacité maximale.
histo src : Histogramme basé sur le volume capté.
histo real : Histogramme basé sur le volume réellement traité.
leaks <identifiant_usine> : Calcul des pertes pour une usine donnée.


Vérifications :

Gérer les erreurs d’arguments incorrects ou incomplets.
Vérifier la présence et la compilation du programme C.


Afficher la durée totale d’exécution en secondes.

Programme C :

Rôle : Réaliser les calculs lourds (histogrammes et pertes).
Utilisation de structures adaptées :

AVL : Pour stocker les identifiants d’usines et optimiser les recherches.
Arbre classique : Pour modéliser le réseau de distribution.


Gestion de la mémoire :

Libérer explicitement les allocations dynamiques.
Limiter l’empreinte mémoire.


Retourner un code d’erreur positif en cas de problème.
Modularité :

Code organisé en fichiers .c et .h.
Compilation via un fichier Makefile.




Exigences supplémentaires :

Livrables :

Lien vers un dépôt GitHub contenant :

Code source (Shell, C, Makefile).
Fichier ReadMe (instructions d’utilisation).
Document PDF (répartition des tâches, planning, limitations).
Dossier tests (exemples d’exécution reproductibles).


Dépôt mis à jour régulièrement (au moins un commit avant et après chaque séance de TD).


Robustesse :

Aucun crash inattendu (segmentation fault, erreur syntaxique, etc.).
Messages d’erreur explicites en cas de problème.


Notation :

Respect des consignes techniques et fonctionnelles.
Code commenté et correctement indenté.
Validation avec un fichier CSV différent pour éviter les solutions "codées en dur".




Bonus :

Histogramme cumulé :

Commande : histo all.
Afficher les 3 volumes (capacité, captage, traitement) imbriqués dans un seul histogramme.


Analyse des fuites :

Identifier le tronçon avec la plus grande perte absolue (en volume, pas en pourcentage).




Ressources utiles :

GitHub : https://github.com/
Format CSV : Documentation CSV
GnuPlot : http://gnuplot.info/

